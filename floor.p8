pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
player = {}
player.x = 24
player.y = 24	

function _init()
	-- borrowed from https://gist.github.com/shaneriley/cae98eac6136e7293b28
	player.direction = "down"
	player.moving = false
	player.sprite = 0
	player.speed = 1

	player.sprites = {
  down = {
    {64, 65, 80, 81},
    {66, 67, 82, 83},
    {68, 69, 84, 85},
    {64, 65, 80, 81}
  },
  up = {
    {70, 71, 86, 87},
    {72, 73, 88, 89},
    {74, 75, 90, 91},
    {70, 71, 86, 87}
  },
  right = {
    {96, 97, 112, 113},
    {98, 99, 114, 115},
    {100, 101, 116, 117},
    {96, 97, 112, 113}
  },
  left = {
    {102, 103, 118, 119},
    {104, 105, 120, 121},
    {106, 107, 122, 123},
    {102, 103, 118, 119}
  }
}
end

function _update()
-- player movement --
	player.moving = false
	local x = player.x
 local y = player.y

  if btn(0) then
    x -= player.speed
    move("left")
  end
  if btn(1) then
    x += player.speed
    move("right")
  end
  if btn(2) then
    y -= player.speed
    move("up")
  end
  if btn(3) then
    y += player.speed
    move("down")
  end
  
  
  --if not hit(x,y, 16, 16) then
    --player.x = x
    --player.y = y
  --end
 	player.x = x
  player.y = y

  if not player.moving then
    player.sprite = 0
  end
end


function _draw()
	cls(1)

	room_x = flr(player.x/16)
	room_y = flr(player.y/16)
	camera(room_x*128,room_y*128)

	-- draw the whole map (128⁙32)
	map()
	
	local frame = player.sprites[player.direction][player.sprite + 1]
	spr(frame[1], player.x*8, player.y*8)
	spr(frame[2], player.x*8 + 8, player.y*8)
	spr(frame[3], player.x*8, player.y*8 + 8)
	spr(frame[4], player.x*8 + 8, player.y*8 + 8)
end

-- borrowed from https://gamedev.docrobs.co.uk/first-steps-in-pico-8-easy-collisions-with-map-tiles
function hit(x, y, w, h)
  for i = x, x + w - 1, 8 do
    for j = y, y + h - 1, 8 do
      local tile_x = flr(i / 8)
      local tile_y = flr(j / 8)
      local tile_id = mget(tile_x, tile_y)
      if fget(tile_id, 0) then  -- check flag 0
        return true
      end
    end
  end
  return false
end

function move(dir)
  player.moving = true
  player.direction = dir
  player.sprite = (player.sprite + 1) % #player.sprites[dir]
end



__gfx__
00000000dddddddd5555555555555555444444444444444444444dddddddd4445555555555555555000000000000000000000000000000000000000000000000
00000000dddddddd5555555555555555444444444444444444444dddddddd4445555555555511111000000000000000000000000000000000000000000000000
00700700dddddddd5555555555555555777776666666666677777dddddddd4445551111155511111000000000000000000000000000000000000000000000000
00077000dddddddd5555555555555555777776666666666677777dddddddd4445551111155511111000000000000000000000000000000000000000000000000
00077000dddddddd5555555555555555777776666666666677777dddddddd4445551111155511111000000000000000000000000000000000000000000000000
00700700dddddddd55555555dddddddd777776666666666677777dddddddd4445551111155511111000000000000000000000000000000000000000000000000
00000000dddddddd55555555dddddddd777776666666666677777dddddddd4445551111155511111000000000000000000000000000000000000000000000000
00000000dddddddd55555555dddddddd777776666666666677777dddddddd4445551111155555555000000000000000000000000000000000000000000000000
0000000044666666dddddddddddddddddddddddd2222222222222ddd555444444444444555555555555546620000000000000000000000000000000000000000
0000000044666666dddddddddddddddddd6666dd2222222222222ddd555440991330044551111555555541770000000000000000000000000000000000000000
000000004466666655dddddddddddd55d655556d2222222222222ddd555440991330044551111555555541770000000000000000000000000000000000000000
00000000446666665500000000000055d655556d2222222222222ddd555440991330044551111555555546620000000000000000000000000000000000000000
00000000445555555500000000000055d655556d2222222222222ddd555440991330044551111555555546660000000000000000000000000000000000000000
00000000445555554444444444444444d655556d2222222222222ddd555444444444444551111555555546660000000000000000000000000000000000000000
00000000445555554444444444444444dd6666dd2222222222222ddd555442200002244551111555555444440000000000000000000000000000000000000000
00000000445555554455466666666444dddddddd2222222222222ddd555442200002244555555555555545550000000000000000000000000000000000000000
00000000666666664455466666666444666666662222222222222ddd555442209992244555555555222664550000000000000000000000000000000000000000
00000000666666664444466666666444666666662222222222222ddd555442209992244555555555ff2664550000000000000000000000000000000000000000
00000000666666664444466666666444666666662222222222222ddd555444444444444551111555ff2664550000000000000000000000000000000000000000
00000000666666664444466666666444666666664444444444444ddd555443308110044551111555222664550000000000000000000000000000000000000000
00000000555555554444444444444444666666664444444444444ddd555443308110044551111555666664550000000000000000000000000000000000000000
0000000055555555449948844444444466666666dddddddddddddddd555443308110044551111555666664550000000000000000000000000000000000000000
0000000055555555444444444444444466666666dddddddddddddddd555443308110044551111555444444450000000000000000000000000000000000000000
0000000055555555444444444444444466666666dddddddddddddddd555444444444444551111555555554550000000000000000000000000000000000000000
0000000044666666dddddddd11111444ddddddddddddd44411111444ddd440000000044d55555555555555550000000000000000000000000000000000000000
00000000446666661111144d11111444dddddd44ddddd44411111444ddd44dddddddd44d55555455555545550000000000000000000000000000000000000000
00000000446666661111144423211444ddddd444ddddd44411811444dddddddddddddddd44444445555444440000000000000000000000000000000000000000
00000000446666662331144433331444ddddd444ddddd44418981444dddddddddddddddd66666455555546660000000000000000000000000000000000000000
00000000445555553331144412311444ddddd444ddddd44418811444dddddddddddddddd66666455555546660000000000000000000000000000000000000000
00000000445555553321144411111444ddddd444ddddd44489811444dddddddddddddddd1fff6455555541110000000000000000000000000000000000000000
0000000044555555131114441111144dddddd444dddddd4418111444dddddddddddddddd1fff6455555541110000000000000000000000000000000000000000
000000004455555511111444ddddddddddddd444dddddddd11111444dddddddddddddddd1fff6455555541110000000000000000000000000000000000000000
00000000000000000222022222220222022202222222022200000000000000000222022222220222022202222222022200000000000000000000000000000000
02220222222202220222222222222222022222222222222202220222222202220222222222222222022222222222222200000000000000000000000000000000
02222222222222220222222222222222022222222222222202222222222222220222222222222222022222222222222200000000000000000000000000000000
02222222222222220022222ff22222200022222ff222222002222222222222220022222222222220002222222222222000000000000000000000000000000000
0022222ff22222200222220fff0222200222220fff02222000222222222222200222222222222220022222222222222000000000000000000000000000000000
0222220fff02222002222f0fff0f222202222f0fff0f222202222222222222200222222222222222022222222222222200000000000000000000000000000000
02222f0fff0f222200222fffffff222000222fffffff222002222222222222220022222222222220002222222222222000000000000000000000000000000000
00222fffffff22200002277777772200000227777777220000222222222222200002222222222200000222222222220000000000000000000000000000000000
00022777777722000000f7777777f0000000f7777777f00000022222222222000000f7777777f0000000f7777777f00000000000000000000000000000000000
0000f7777777f000000001111111000000000111111100000000f7777777f0000000011111110000000001111111000000000000000000000000000000000000
00000111111100000000011111110000000001111111000000000111111100000000011111110000000001111111000000000000000000000000000000000000
00000111111100000000011101110000000001110111000000000111111100000000011101110000000001110111000000000000000000000000000000000000
00000111011100000000000001110000000001110000000000000111011100000000000001110000000001110000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000022202222220000002220222222000000000000000000000022222202220000002222220222000000000000000000000000000000000000
00222022222200000022222222222000002222222222200000222222022200000222222222220000022222222222000000000000000000000000000000000000
00222222222220000022222222222200002222222222220002222222222200002222222222220000222222222222000000000000000000000000000000000000
00222222222222000002222222222200000222222222220022222222222200002222222222200000222222222220000000000000000000000000000000000000
0002222222222200002222222222f200002222222222f20022222222222000002f222222222200002f2222222222000000000000000000000000000000000000
002222222222f200022222222220f000022222222220f0002f222222222200000f022222222220000f0222222222200000000000000000000000000000000000
022222222220f0000222222222f0f0000222222222f0f0000f022222222220000f0f2222222220000f0f22222222200000000000000000000000000000000000
0222222222f0f0000022222222fff0000022222222fff0000f0f2222222220000fff2222222200000fff22222222000000000000000000000000000000000000
0022222222fff000000222222277000000022222227700000fff2222222200000077222222200000007722222220000000000000000000000000000000000000
00022222227700000000007ff77700000000007ff7770000007722222220000000777ff70000000000777ff70000000000000000000000000000000000000000
0000007ff77700000000001111110000000000111111000000777ff7000000000011111100000000001111110000000000000000000000000000000000000000
00000011111100000000001111110000000000111111000000111111000000000011111100000000001111110000000000000000000000000000000000000000
00000011111100000000001110110000000000111011000000111111000000000011011100000000001101110000000000000000000000000000000000000000
00000011101100000000001110000000000000000011000000110111000000000000011100000000001100000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000202020202020101010101010102020200000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000202020202020101010101010102020200000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000202020202020101010101010102020200000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000202020202020101010101010102020200000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000202020202020101010101010102020200000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000020202020809210101010104323a393200000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000020202020909110101010107063a1a2200000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000202020202020101010101053332020200000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000202020202020101010101010102020200000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000202020202020101010101010102020200000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000550000555000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000202020202020111210101010102020200000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000005000000555505500000000000000000000000000000000000000000000000000000
00000000000000000000000000000000202020202020111210101010102020200000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000050000000000005000500000000000000000000000000000000000000000000000000
00000000000000000000000000000000202020202020111210101010102020200000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000500000000000050500055000000000000000000000000000000000000000000000000
00000000000000000000000000000000202020202020131210101010102020200000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000500000000000500050000550000000000000000000000000000000000000000000000
00000000000000000000000000000000202020202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000500000000000000050000050000000000000000000000000000000000000000000000
00000000000000000000000000000000202020202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000005000000000000550000050000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000555000000005500000050000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000055000000005000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000005500550000000000000000000000000000000000000000000000000
__gff__
0000000101010000000000000000000000000100010000000000000000000000000101010101000000000000000000000001010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002020202020217181718020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002020202020227282728020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000008290405060137383738010101010202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000009191515160101010101010101010202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002021515160101010101010101010202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002021515160101010101010101010202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002022525260101010101010101010202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002020101010101010101010101010202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002020101010101010101010101010202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002020101010101010101010101010124000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002020101010101010101010101010124000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002020101121301010101010101010202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002020114222301010101010101010202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002020202020202020201010202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002020202020202020201010202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
