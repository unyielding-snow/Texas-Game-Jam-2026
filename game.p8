pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
function _init()
	-- borrowed from https://gist.github.com/shaneriley/cae98eac6136e7293b28
	player = {}
	player.x = 25
	player.y = 25
	player.direction = "down"
	player.moving = false
	player.sprite = 0
	player.speed = 1

	player.sprites = {
  down = {
    {64, 65, 80, 81},
    {66, 67, 82, 83},
    {68, 69, 84, 85},
    {64, 65, 80, 81}
  },
  up = {
    {70, 71, 86, 87},
    {72, 73, 88, 89},
    {74, 75, 90, 91},
    {70, 71, 86, 87}
  },
  right = {
    {96, 97, 112, 113},
    {98, 99, 114, 115},
    {100, 101, 116, 117},
    {96, 97, 112, 113}
  },
  left = {
    {102, 103, 118, 119},
    {104, 105, 120, 121},
    {106, 107, 122, 123},
    {102, 103, 118, 119}
  }
}
end

function _update()
-- player movement --
	player.moving = false
	local x = player.x
 local y = player.y

  if btn(0) then
    x -= player.speed
    move("left")
  end
  if btn(1) then
    x += player.speed
    move("right")
  end
  if btn(2) then
    y -= player.speed
    move("up")
  end
  if btn(3) then
    y += player.speed
    move("down")
  end
  
  if not hit(x,y, 16, 16) then
    player.x = x
    player.y = y
  end

  if not player.moving then
    player.sprite = 0
  end
end


function _draw()
	cls()
	map()
	
	local frame = player.sprites[player.direction][player.sprite + 1]
	spr(frame[1], player.x, player.y)
	spr(frame[2], player.x + 8, player.y)
	spr(frame[3], player.x, player.y + 8)
	spr(frame[4], player.x + 8, player.y + 8)
end

-- borrowed from https://gamedev.docrobs.co.uk/first-steps-in-pico-8-easy-collisions-with-map-tiles
function hit(x, y, w, h)
  for i = x, x + w - 1, 8 do
    for j = y, y + h - 1, 8 do
      local tile_x = flr(i / 8)
      local tile_y = flr(j / 8)
      local tile_id = mget(tile_x, tile_y)
      if fget(tile_id, 0) then  -- check flag 0
        return true
      end
    end
  end
  return false
end

function move(dir)
  player.moving = true
  player.direction = dir
  player.sprite = (player.sprite + 1) % #player.sprites[dir]
end



__gfx__
00000000dddddddd66666666ddddddddffffffffdddddddd7733333ddddddddd0000000000000000555555555555555555555555555555555555555555555555
00000000dddddddd66666666dddddddd44444444dc7ccccd77dddddddddddddd0000000000000000555555556666660550666666500600600600600600600600
00700700dddddddd66666666ddd6666677666677d777cacddddddddddddddddd0000000000000000555555556666660550666666566066066066066066066066
00077000dddddddd66666666ddd6ccc677666677dccccccddddddddddddddddd0000000000000000555555550000006556000000566066066066066066066066
00077000dddddddd66666666ddd6ccc611111111dc7ccbcddddddddddddddddd0000000000000000555555556666660550666666566066066066066066066066
00700700dddddddd66666666ddd6ccc61111111177cccbcdddddddddddddddd70000000000000000555555556666660550666666566066066066066066066066
00000000dddddddd66666666ddd6ccc61111111177ccc4cdddddddddddddddd70000000000000000555555550000006556000000566066066066066066066066
00000000dddddddd66666666ddd66666111111117733333dddddddddddddddd70000000000000000555555556666660550666666566066066066066066066066
00000000ffffffff444444445555555511111111ffffffffddddddd7dddddddd0000000000000000666666666666660550666666555555555660660660660660
00000000ffffffff4e0112045555555511111111ffffffffddddddd7dddddddd0000000000000000666666660000006556000000600655555660660660660660
00000000ffffffff4e1012245555555511111111ffffffffdddddddd666666660000000000000000666666666666660550666666066055555660660660660660
00000000ffffffff44444444555555551111111150000005dddddddd666666660000000000000000666666666666660550666666066055555660660660660660
00000000ffffffff4230e004555555551111111144444444dddddddd666666660000000000000000666666660000006556000000066055555660660660660660
00000000ffffffff423e0aa4555555551111111144666644dddddddd666666660000000000000000666666666666660550666666066055555660660660660660
00000000ffffffff44444444555555554444444494666645dddddddd666566660000000000000000666666666666660550666666066055555006006006006006
00000000ffffffff488b1e0455555555ffffffff44666645dddddddddddddddd0000000000000000666666660000006556000000066055555555555555555555
00000000ffffffff4ccb1e04ddd6ccc6ccc6dddddddddddd00000000000000000000000000000000555555556666660550666666660660660660555555666655
00000000ffffffff44444444ddd6ccc6ccc6dddddddddddd00000000000000000000000000000000555555556666660550666666660660660660555555666655
00000000fff4422441a0e084ddd6ccc6ccc6dddd6666dddd00000000000000000000000000000000666666650000006556000000660660660660555555666655
00000000fff5422441a99e84ddd6ccc6ccc6ddddccc6dddd00000000000000000000000000000000666666656666660550666666660660660660555555066655
00000000fff5411344444444ddd666666666ddddccc6dddd00000000000000000000000000000000666666656666660550666666660660660660555555666655
00000000fff5413345555554ddddddddddddddddccc6dddd00000000000000000000000000000000666066650000006556000000660660660660555555666655
00000000fff54224ffffffffddddddddddddddddccc6dddd00000000000000000000000000000000555555556666660550666666006006006006555555666655
00000000fff54664ffffffffdddddddddddddddd6666dddd00000000000000000000000000000000555555556666660550666666555555555555555555555555
00000000fff546644666664f4666664fffffffff0000000000000000000000000000000000000000555555550000006556000000555555550000000000000000
00000000fff546644666664f4666664fff8888880000000000000000000000000000000000000000555555556666660550666666556666550000000000000000
00000000fff542244555554f4555554fff8888880000000000000000000000000000000000000000566606666666660550666666556666550000000000000000
00000000fff542244555554f4555554ffffffff80000000000000000000000000000000000000000566666660000006556000000556666550000000000000000
00000000fff442244666664f4666664fffffffff0000000000000000000000000000000000000000566666665555555555555555556660550000000000000000
00000000ffffffff4666664f4666664fffffffff0000000000000000000000000000000000000000566666665555555555555555556666550000000000000000
00000000ffffffff4555554f4555554fffffffff0000000000000000000000000000000000000000555555555555555555555555556666550000000000000000
00000000ffffffff4555554f4444444fffffffff0000000000000000000000000000000000000000555555555555555555555555556666550000000000000000
00000000000000000222022222220222022202222222022200000000000000000222022222220222022202222222022200000000000000000000000000000000
02220222222202220222222222222222022222222222222202220222222202220222222222222222022222222222222200000000000000000000000000000000
02222222222222220222222222222222022222222222222202222222222222220222222222222222022222222222222200000000000000000000000000000000
02222222222222220022222ff22222200022222ff222222002222222222222220022222222222220002222222222222000000000000000000000000000000000
0022222ff22222200222220fff0222200222220fff02222000222222222222200222222222222220022222222222222000000000000000000000000000000000
0222220fff02222002222f0fff0f222202222f0fff0f222202222222222222200222222222222222022222222222222200000000000000000000000000000000
02222f0fff0f222200222fffffff222000222fffffff222002222222222222220022222222222220002222222222222000000000000000000000000000000000
00222fffffff22200002277777772200000227777777220000222222222222200002222222222200000222222222220000000000000000000000000000000000
00022777777722000000f7777777f0000000f7777777f00000022222222222000000f7777777f0000000f7777777f00000000000000000000000000000000000
0000f7777777f000000001111111000000000111111100000000f7777777f0000000011111110000000001111111000000000000000000000000000000000000
00000111111100000000011111110000000001111111000000000111111100000000011111110000000001111111000000000000000000000000000000000000
00000111111100000000011101110000000001110111000000000111111100000000011101110000000001110111000000000000000000000000000000000000
00000111011100000000000001110000000001110000000000000111011100000000000001110000000001110000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000022202222220000002220222222000000000000000000000022222202220000002222220222000000000000000000000000000000000000
00222022222200000022222222222000002222222222200000222222022200000222222222220000022222222222000000000000000000000000000000000000
00222222222220000022222222222200002222222222220002222222222200002222222222220000222222222222000000000000000000000000000000000000
00222222222222000002222222222200000222222222220022222222222200002222222222200000222222222220000000000000000000000000000000000000
0002222222222200002222222222f200002222222222f20022222222222000002f222222222200002f2222222222000000000000000000000000000000000000
002222222222f200022222222220f000022222222220f0002f222222222200000f022222222220000f0222222222200000000000000000000000000000000000
022222222220f0000222222222f0f0000222222222f0f0000f022222222220000f0f2222222220000f0f22222222200000000000000000000000000000000000
0222222222f0f0000022222222fff0000022222222fff0000f0f2222222220000fff2222222200000fff22222222000000000000000000000000000000000000
0022222222fff000000222222277000000022222227700000fff2222222200000077222222200000007722222220000000000000000000000000000000000000
00022222227700000000007ff77700000000007ff7770000007722222220000000777ff70000000000777ff70000000000000000000000000000000000000000
0000007ff77700000000001111110000000000111111000000777ff7000000000011111100000000001111110000000000000000000000000000000000000000
00000011111100000000001111110000000000111111000000111111000000000011111100000000001111110000000000000000000000000000000000000000
00000011111100000000001110110000000000111011000000111111000000000011011100000000001101110000000000000000000000000000000000000000
00000011101100000000001110000000000000000011000000110111000000000000011100000000001100000000000000000000000000000000000000000000
__gff__
0000000101010000000000000000000000000100010000000000000000000000000101010101000000000000000000000001010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0101070501010101000000000000000000000000000001010101110101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101160612120101000000000000000000000000000001011111110101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0325041122221101000000000000000000000000000001011111110101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2324141111111101000000000000000000000000000001011111110101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101111111111117000000000000000a0a0a0a00000003251111210101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101151111111101000000000000000a0a0a0a00000023241111310101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101110101000000000000000a0a0a0a00000001011111110101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101011111110101000000000000000a0a0a0000000001013211111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101011111110101000000000000000a0a0a0a0a000001013311111111111111010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101011111110101000000000000000a0a0a0a0a000001010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101011111210101000000000000000a0a0a0a0a000001010101010101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101011111310101010101000000000a0a0a0a0a00000a0a0a0a0a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010101111111010101010100000a0a0a0a0a0a0a0a0a0a0a0a0a0a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010101321111111111111100000a0a0a0a0a0a0a0a0a0a0a0a0a0a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010101331111111111110100000a0a0a0a0a0a0a0a0a0a0a0a0a0a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010101010101010101010100000a0a0a0a0a0a0a0a0a0a0a0a0a0a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101000a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000a0a0a0a0a0a0a0a0a0a0a0a0a0a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010101321101010101010101010a0a0a0a0a0a0a0a0a0a0a0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010101321101010101010101010a0a0a0a0a0a0a0a0a0a0a0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
011111111111111101010101010a0a0a0a0a0a0a0a0a0a0a0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
011111111111111111111101010a0a0a0a0a0a0a0a0a0a0a0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
011111111111111111111101013d0d0e0f1d0a0a0a0a0a0a0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
011111111111111111111101011a1a1a1a1a1a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a111111111111111111111a1a1a1a1a1a1a1a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a111111111111111111111a1a1a1a1a1a1a1a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a111111111111111111111e1f2d2e0a0a0a0a0a0a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
